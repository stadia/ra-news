<%= turbo_frame_tag "new_comment" do %>
  <div class="bg-gray-700 rounded-xl p-6 border border-gray-600" data-controller="character-count" data-character-count-max-length-value="<%= Comment::MAX_BODY_LENGTH %>">
    <h4 class="text-lg font-semibold text-gray-100 mb-4 flex items-center">
      <%= heroicon "pencil-square", variant: :outline, options: { class: "w-5 h-5 mr-2 text-blue-400" } %>
      댓글 작성
    </h4>

    <%= form_with(model: [article, comment], url: article_comments_path(article.slug), local: false, class: "space-y-4") do |f| %>
      <% if comment.errors.any? %>
        <div class="bg-red-900 bg-opacity-50 border border-red-500 text-red-200 px-4 py-3 rounded-lg">
          <div class="flex items-center mb-2">
            <%= heroicon "exclamation-circle", variant: :mini, options: { class: "w-5 h-5 mr-2" } %>
            <h5 class="font-medium">오류가 발생했습니다:</h5>
          </div>
          <ul class="list-disc list-inside space-y-1 text-sm">
            <% comment.errors.each do |error| %>
              <li><%= error.full_message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div class="space-y-2">
        <%= f.label :body, "댓글 내용", class: "block text-sm font-medium text-gray-300" %>
        <%= f.text_area :body,
            rows: 4,
            class: [
              "w-full px-4 py-3 rounded-lg border bg-white text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 resize-none",
              (comment.errors[:body].none? ? "border-gray-600 hover:border-gray-500" : "border-red-500 focus:ring-red-500")
            ].join(' '),
            placeholder: "댓글을 입력하세요...",
            maxlength: Comment::MAX_BODY_LENGTH,
            data: { character_count_target: "input", action: "input->character-count#updateCount" } %>
        <div class="text-xs text-gray-400 text-right">
          <span data-character-count-target="counter">0</span>/<%= Comment::MAX_BODY_LENGTH %>
        </div>
      </div>

      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div class="text-xs text-gray-400">
          <%= heroicon "information-circle", variant: :outline, options: { class: "w-4 h-4 inline mr-1" } %>
          정중하고 건설적인 댓글을 작성해 주세요.
        </div>

        <%= f.submit "댓글 작성",
            class: "inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 focus:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-800" %>
      </div>
    <% end %>
  </div>
<% end %>
